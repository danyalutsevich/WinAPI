GDI\GDC

Графический интерфейс (контекст устройства)

Договоренность / набор инструментов 
для "рисования" на устройстве

Контекст устройства - адаптер (промежуточное звено)
реализующее интерфейс - переводящее графические команды в отображение
Для рисования на окне
1 Получаем контекст устройства 

	HDC dc = GetDC(hWnd); // DC - device context

2 Создаем инструмент рисования
  HPEN pen = CreatePen(PS_SOLID,2,RGB(255,0,0));

3  Устанавливаем этот инструмент. Принцип выталкивания
  результатом установки ест дескриптор предыдущего инструмента
          HPEN savedPen = (HPEN)SelectObject(dc, pen);

4 Используем

LineTo(dc, GET_X_LPARAM(lParam), GET_Y_LPARAM(lParam));

5 Востанавливаем инструмент, который мы "вытолкнули"
SelectObject(dc, savedPen);

6 Освобождаем инструмент
  DeleteObject(pen);

7 Освобождаем контекст
 ReleaseDC(hWnd,dc);
 
1, 7 - контекст устройства регистрируется в системе (есть
 ресурсом ОС). При его создании ОС возвращает дескриптор,
 по которому его нужно позже удалить. Если ресурс не удаляется
 то происходит утечка ресурсов


2, 6 суть таже. Ресурсы рисования - перья (Pen) и кисти
   (BRUSH). перья рисуют линии, кисти закрашивают (заливают)
   области.

3 Контекст устройства может использоваться для разных задач
(разными обьектами, разными сообщениями).
Если оставить установленный ресурс, не востановив старый,
то это может повлиять на работу других процессов
4 использование интерфейсных функций - стандартных для разных
языков / устройств
MoveTo - переход в точку без рисования
LineTo - переход в точку с рисования



Захват мыши
SetCapure(hWnd); // все события будут приходить в окно hWnd
ReleaseCapture(); // снимает захват

рисование на GDI не сохраняет нарисованную информацию на самом устройстве 
Все фигуры и просто засвеченные пиксели не становятся частью окна и,
как следствие не перерисовываются при необходимости

при выхода части окна за границы экрана (выход части за экран)
при сворачивании / разворачивании окна
(иногда при перекрытии другими окнами)


при перерисовке посылается сообщение WM_PAINT, в нем используется 
структура PAINTSTRUCT ps; хранящая информацию об областью перерисовки


Для того чтобы сохранять данные о рисунке поступают следующим образом:
- создается копия рисунка в память
- создается для этой копии DC такой же, как и для окна
- все акты рисования дублируются как на окне так и в памяти 
- при перерисовки на окно копируются сохраненный рисунок (или его фрагмент)














